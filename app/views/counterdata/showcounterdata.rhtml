<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>New Page 1</title>

<script>
function showsave1()
{
	var btsave1 = document.getElementById("save");
      
        btsave1.disabled=false;

	 	btsave1.focus();

}

function showsave()
{
	
	if(event.keyCode==13)
	{
	 	var btsave1 = document.getElementById("save");
      
        btsave1.disabled=false;

	 	btsave1.focus();
	 }	
}

function calculatetotal1(obj)
{
	
	if(obj.value.length<1)
	{
	
	alert("Please enter value");
	obj.focus();
	return false;
	}
	else
	{
	
	var total1=document.getElementById("total1");
	var cash=document.getElementById("counterdata_Cash").value;
	
	var Exp=document.getElementById("counterdata_Exp").value;
	var hc=document.getElementById("counterdata_HC").value;
	var cr=document.getElementById("counterdata_Credit").value;
	var sht_ext=document.getElementById("counterdata_ShortExt").value;
	
	

	var sum=parseInt(cash)+parseInt(Exp)+parseInt(hc)+parseInt(cr)+parseInt(sht_ext);
	total1.value=sum;
	return true;
	}
	
}

function calsh()
{
var total1=document.getElementById("total1");
	var cash=document.getElementById("counterdata_Cash").value;
	
	var Exp=document.getElementById("counterdata_Exp").value;
	var hc=document.getElementById("counterdata_HC").value;
	var cr=document.getElementById("counterdata_Credit").value;
	var sht_ext=document.getElementById("counterdata_ShortExt").value;
	
	

	var sum=parseInt(cash)+parseInt(Exp)+parseInt(hc)+parseInt(cr)+parseInt(sht_ext);
	total1.value=sum;
	return true;

}

function calculatetotal2(obj)
{

	if(obj.value.length<1)
	{
	alert("Please Enter Value");
	obj.focus();
	return false;
	}
	else
	{	
	var total2=document.getElementById("total2");
	
	var OPENBAL=document.getElementById("counterdata_Openingbal").value;
	
	//document.getElementById("counterdata_openingbal").value;
	var KEY1=document.getElementById("counterdata_KEY1").value;
	
	var KEY2=document.getElementById("counterdata_KEY2").value;
	
	var KEY3=document.getElementById("counterdata_KEY3").value;
	
	var KEY4=document.getElementById("counterdata_KEY4").value;
	var outstd=document.getElementById("counterdata_outstanding").value;
	
	var sum=parseInt(OPENBAL)+parseInt(KEY1)+parseInt(KEY2)+parseInt(KEY3)+parseInt(KEY4)+parseInt(outstd);

	
	total2.value=sum;
	return true;
	}
	
	
}

function Check()
{
	var total1=document.getElementById("total1").value;
	var total2=document.getElementById("total2").value;
	//var x=document.getElementByID("total1"); 
	var cash=document.getElementById("counterdata_Cash");

	if(total1==0 || total2==0)
	{
		alert("Please fill form values");
		
		var btsave1 = document.getElementById("save");
      
        btsave1.disabled=true;

		cash.focus();
		return(false);
	}
	else
	{
		if(total1!=total2)
			{
				alert("Both total not matching");
				cash.focus();
				var btsave1 = document.getElementById("save");
      
        btsave1.disabled=true;

				return(false);
			}
		return(true);
	}

}
function onlyNumbers(evt)
{
	var e = event || evt; // for trans-browser compatibility
	var charCode = e.which || e.keyCode;
	
	if (charCode > 31 && (charCode < 48 || charCode > 57))
		return false;
    
	return true;

}
function onlyNumbersminus(evt)
{
	
	var e = event || evt; // for trans-browser compatibility
	var charCode = e.which || e.keyCode;
	if(charCode==45)
		return true
	else if(charCode > 31 && (charCode < 48 || charCode > 57))
		return false;
    else
	return true;

}

function checkshort()
{
	
	var sh=document.getElementById("counterdata_ShortExt");
	if(sh.value.length<1)
	{
		sh.value="0";
	}
	if(sh.value!="0")
	{
	var ans=confirm("ARE YOU SURE YOU WANT TO CHANGE SHORT EXTRA");
	if(ans)
	{
		calsh();
	}
	else
	{
	var sh=document.getElementById("counterdata_ShortExt");

	sh.value="0";
	}
	}
	
}
</script>
<script type="text/javascript">


window.onload=function()
{

var cash=document.getElementById('counterdata_Cash');
var key1=document.getElementById('counterdata_KEY1');
var key2=document.getElementById('counterdata_KEY2');
var key3=document.getElementById('counterdata_KEY3');
var key4=document.getElementById('counterdata_KEY4');
/*
if(key1.value==0)
{
key1.disabled=true;
}
if(key2.value==0)
{
key2.disabled=true;
}
if(key3.value==0)
{
key3.disabled=true;
}
if(key4.value==0)
{
key4.disabled=true;
}
*/
cash.focus();
var btsave1 = document.getElementById("save");
      
        btsave1.disabled=true;
}

function checkoccerance11111(sText)

	{
   		
   		var Char;
		var count=0;
 
   		for (i = 0; i < sText.length; i++) 
      		{ 
      			Char = sText.charAt(i); 
      			if (Char=='-') 
      			{
      				count=count+1;
      			}
      			
      			if (count>1)
      			break;
      		}
      		
	  		return count;
   
   	}
function checkoccerance(sText)

{

		var Char;
		var count=0;
		if (sText.charAt(0)=='-' && sText.charAt(1)=='')
		{
			count=40;
		}
		else
		{
			for (i = 0; i < sText.length; i++)
			{
				Char = sText.charAt(i);
				if (Char=='-')
				{
					count=count+1;
					if(i>0)
					{
						count=50;
						break;
					}

				}

			}
		}
		return count;

}

function minussigns()
{
var csh=document.getElementById("counterdata_ShortExt");
//alert(csh.value);
value=checkoccerance(csh.value);
if (value<=1)
	return true;
else
	{
		alert("Please Enter Proper value for Short Extra");
		csh.value=0;
		csh.focus();
		csh.select();
		return false;
	}

}

function minussignsforkey1()
{
var k1=document.getElementById("counterdata_KEY1");

if (k1.value.length>0)
{
	//alert(k1.value);
	value=checkoccerance(k1.value);
	if (value<=1)
		return true;
	else
	{
		alert("Please Enter Proper value for KEY 1");
		k1.value=0;
		k1.focus();
		k1.select();
		return false;
	}
}
else
{
alert("Please Enter value for KEY 1");
		k1.value=0;
		k1.focus();
		k1.select();

return false;
}
}


function minussignsforkey2()
{
var k2=document.getElementById("counterdata_KEY2");

if (k2.value.length>0)
{
	//alert(k2.value);
	value=checkoccerance(k2.value);
	if (value<=1)
		return true;
	else
	{
		alert("Please Enter Proper value for KEY 2");
		k2.value=0;
		k2.focus();
		k2.select();
		return false;
	}
}
else
{
alert("Please Enter value for KEY 2");
		k2.value=0;
		k2.focus();
		k2.select();

return false;
}
}

function minussignsforkey3()
{
var k3=document.getElementById("counterdata_KEY3");

if (k3.value.length>0)
{
	//alert(k3.value);
	value=checkoccerance(k3.value);
	if (value<=1)
		return true;
	else
	{
		alert("Please Enter Proper value for KEY 3");
		k3.value=0;
		k3.focus();
		k3.select();
		return false;
	}
}
else
{
alert("Please Enter value for KEY 3");
		k3.value=0;
		k3.focus();
		k3.select();

return false;
}
}

function minussignsforkey4()
{
var k4=document.getElementById("counterdata_KEY4");

if (k4.value.length>0)
{
	//alert(k4.value);
	value=checkoccerance(k4.value);
	if (value<=1)
		return true;
	else
	{
		alert("Please Enter Proper value for KEY 4");
		k4.value=0;
		k4.focus();
		k4.select();
		return false;
	}
}
else
{
alert("Please Enter value for KEY 4");
		k4.value=0;
		k4.focus();
		k4.select();

return false;
}
}
function minussignsforos()
{
var os=document.getElementById("counterdata_Outstanding");

if (os.value.length>0)
{
	//alert(os.value);
	value=checkoccerance(os.value);
	if (value<=1)
		return true;
	else
	{
		alert("Please Enter Proper value for O/S");
		os.value=0;
		os.focus();
		os.select();
		return false;
	}
}
else
{
alert("Please Enter value for O/S");
		os.value=0;
		os.focus();
		os.select();

return false;
}
}



</script>
</head>

<body>
 
<% form_tag :action => 'update', :id => @counterdata do %>


<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" width="100%" id="AutoNumber1" height="350">
  <tr>
    <td width="100%" height="330" align=center>
   
   
    

    
    

    <table border="1" cellpadding="0" cellspacing="0"  bgcolor="#C0C0C0" style="border-collapse: collapse" bordercolor="#6C3401" width="80%" id="AutoNumber2" height="219">
      <tr>
        <td width="100%" height="1"><h3 align="center">Counter Collection</h3></td>
      </tr>
      <tr>
        <td width="100%" height="11">
        <%= error_messages_for 'counterdata' %>

        <table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber3" height="19">
          <tr>
            <td width="50%" height="9"><label for="counterdata_ShopName">SHOP 
            NAME</label>
<%= text_field 'counterdata', 'ShopName', :disabled=>true,:size=>20 %>
</td>
            <td width="50%" height="9"><label for="counterdata_Date">DATE</label>
<%= text_field 'counterdata', 'Date',:disabled=>true,:size=>20 %></td>
          </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td width="100%" height="236">
        <table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber4" height="236">
          <tr>
             		<td width="25%" height="34" align="right"><label >Cash</label></td>
             		<td width="25%" height="34">
             		<%= text_field 'counterdata', 'Cash',:onblur=>"calculatetotal1(this);" ,:onkeypress=>"return onlyNumbers();"  ,:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_Exp.focus();",:onFocus=>"this.select();",:size=>"20"%></td>
             		<td width="25%" height="34" align="right"><label for="counterdata_Openingbal">O/B</label></td>
             		<td width="25%" height="34">
             		<%= text_field 'counterdata', 'Openingbal',:readonly=>true,:size=>20 %>
             		</td>
		 </tr>
          <tr>
					
					<% @c =Group.count(["ShopName=?",@session[:tshopname]]) %>

					<td width="25%" height="34" align="right"><label for="counterdata_Exp">Exp</label></td>
					<td width="25%" height="34">
					
					<%= text_field 'counterdata', 'Exp',:onkeypress=>"return onlyNumbers();",:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_HC.focus();",:onblur=>"calculatetotal1(this);",:onFocus=>"this.select();",:size=>"20"%>
					
					</td>

					</td>
            		<td width="25%" height="34" align="right"><label for="counterdata_KEY1">KEY 1</label></td>
            		<td width="25%" height="34">
          			
          				
	          		<!--<%= text_field 'counterdata', 'KEY2',:onchange=>"return minussignsforkey2();",:onkeypress=>"return onlyNumbersminus();",:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_Outstanding.focus();",:onblur=>"calculatetotal2(this);",:onFocus=>"this.select();",:size=>"20"%>-->
	          		<% if(@c>=1) %>
            			<%if(@c==1)%>
            		<%= text_field 'counterdata', 'KEY1',:onchange=>"return minussignsforkey1();",:onkeypress=>"return onlyNumbersminus();",:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_Outstanding.focus();",:onblur=>"calculatetotal1(this);",:onFocus=>"this.select();",:size=>"20"%>
            		<!--<input type="text" name="countercollection[KEY1]" id="countercollection_KEY1" size="20" onchange="return minussignsforkey1();" onkeypress="return onlyNumbersminus();" onKeyDown="if(event.keyCode==13)  this.form.counterdata_Outstanding.focus();" onblur="calculatetotal2(this);" maxlength="6" value="0" onFocus="this.select();">-->
            			<%else%>
	            		<%= text_field 'counterdata', 'KEY1',:onchange=>"return minussignsforkey1();",:onkeypress=>"return onlyNumbersminus();",:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_KEY2.focus();",:onblur=>"calculatetotal1(this);",:onFocus=>"this.select();",:size=>"20"%>

            			
            			<%end%>

            		
            		<%else%>
          			<input type="text" name="counterdata[KEY1]" id="counterdata_KEY1" size="20"  value="0" disabled>
					
            		<!--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------->
            	
            		<% end %>

						
          			</td>
            		
           </tr>
          <tr>
  
            		<td width="25%" height="34" align="right"><label for="counterdata_HC">Hc</label></td>
            		<td width="25%" height="34">
            			<%= text_field 'counterdata', 'HC',:onkeypress=>"return onlyNumbers();",:onblur=>"calculatetotal1(this);",:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_Credit.focus();",:onFocus=>"this.select();",:size=>"20"%>
            			
            	

				</td>
            		
          			<td width="25%" height="34" align="right"><label for="counterdata_KEY2">KEY 2</label></td>
          			<td width="25%" height="34">
          			
          				
	          		<!--<%= text_field 'counterdata', 'KEY2',:onchange=>"return minussignsforkey2();",:onkeypress=>"return onlyNumbersminus();",:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_Outstanding.focus();",:onblur=>"calculatetotal2(this);",:onFocus=>"this.select();",:size=>"20"%>-->
	          		<% if(@c>=2) %>
            			<%if(@c==2)%>
            		<%= text_field 'counterdata', 'KEY2',:onchange=>"return minussignsforkey1();",:onkeypress=>"return onlyNumbersminus();",:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_Outstanding.focus();",:onblur=>"calculatetotal2(this);",:onFocus=>"this.select();",:size=>"20"%>
            		<!--<input type="text" name="countercollection[KEY1]" id="countercollection_KEY1" size="20" onchange="return minussignsforkey1();" onkeypress="return onlyNumbersminus();" onKeyDown="if(event.keyCode==13)  this.form.counterdata_Outstanding.focus();" onblur="calculatetotal2(this);" maxlength="6" value="0" onFocus="this.select();">-->
            			<%else%>
            			
            			<%= text_field 'counterdata', 'KEY2',:onchange=>"return minussignsforkey1();",:onkeypress=>"return onlyNumbersminus();",:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_KEY3.focus();",:onblur=>"calculatetotal2(this);",:onFocus=>"this.select();",:size=>"20"%>

            			<%end%>

            		
            		<%else%>
          			<input type="text" name="counterdata[KEY2]" id="counterdata_KEY2" size="20"  value="0" disabled>

            		<!--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------->
            	
            		<% end %>

						
          			</td>
          </tr>
          <tr>
          			
          			<td width="25%" height="34" align="right">CR</td>
          			<td width="25%" height="34">
          			

          			<%= text_field 'counterdata', 'Credit',:onblur=>"calculatetotal1(this);",:onkeypress=>"return onlyNumbers();",:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_ShortExt.focus();",:onFocus=>"this.select();",:size=>"20"%></td>
					<td width="25%" height="34" align="right"><label for="counterdata_KEY3">KEY 3</label></td>
				<td width="25%" height="34">
					
          			<!--<%= text_field 'counterdata', 'KEY3',:onchange=>"return minussignsforkey3();",:onkeypress=>"return onlyNumbersminus();",:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_Outstanding.focus();",:onblur=>"calculatetotal2(this);",:onFocus=>"this.select();" ,:size=>"20"%>-->
          			<% if(@c>=3) %>
            			<%if(@c==3)%>
            		<%= text_field 'counterdata', 'KEY3',:onchange=>"return minussignsforkey3();",:onkeypress=>"return onlyNumbersminus();",:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_Outstanding.focus();",:onblur=>"calculatetotal2(this);",:onFocus=>"this.select();",:size=>"20"%>
            		<!--<input type="text" name="countercollection[KEY1]" id="countercollection_KEY1" size="20" onchange="return minussignsforkey1();" onkeypress="return onlyNumbersminus();" onKeyDown="if(event.keyCode==13)  this.form.counterdata_Outstanding.focus();" onblur="calculatetotal2(this);" maxlength="6" value="0" onFocus="this.select();">-->
            			<%else%>
            			<input type="text" name="counterdata[KEY3]" id="counterdata_KEY3" size="20" onchange="return minussignsforkey3();" onkeypress="return onlyNumbersminus();" onKeyDown="if(event.keyCode==13)  this.form.counterdata_KEY4.focus();" onblur="calculatetotal2(this);" maxlength="6" value="0" onFocus="this.select();">
            			<%end%>

            		
            		<%else%>
            		<!--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------->
            		          			<input type="text" name="counterdata[KEY3]" id="counterdata_KEY3" size="20"  value="0" disabled>
            	
            		<% end %>

          			
					
					
					
					</td>
          			
          	
		 </tr>
          <tr>		
          			
            		<td width="25%" height="34" align="right"><label for="counterdata_Short_Ext">Short ext</label></td>
            		<td width="25%" height="34">
            		<%= text_field 'counterdata', 'Short_Ext',:id=>'counterdata_ShortExt',:onchange=> "return minussigns();", :onblur=>"checkshort();",:onkeypress=>"return onlyNumbersminus();",:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_KEY1.focus();",:onFocus=>"this.select();" ,:size=>"20"%></td>

            		</td>
            		<td width="25%" height="34" align="right"><label for="counterdata_KEY4">KEY 4</label></td>
            		<td width="25%" height="34">
            		
            		      <!--<%= text_field 'counterdata', 'KEY4',:onchange=>"return minussignsforkey4();",:onkeypress=>"return onlyNumbersminus();",:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_Outstanding.focus();",:onblur=>"calculatetotal2(this);",:onFocus=>"this.select();",:size=>"20"%>-->
            		      <% if(@c>=4) %>
            			<%if(@c==4)%>
            		<%= text_field 'counterdata', 'KEY4',:onchange=>"return minussignsforkey4();",:onkeypress=>"return onlyNumbersminus();",:onKeyDown=>"if(event.keyCode==13)  this.form.counterdata_Outstanding.focus();",:onblur=>"calculatetotal2(this);",:onFocus=>"this.select();",:size=>"20"%>
            		<!--<input type="text" name="countercollection[KEY1]" id="countercollection_KEY1" size="20" onchange="return minussignsforkey1();" onkeypress="return onlyNumbersminus();" onKeyDown="if(event.keyCode==13)  this.form.counterdata_Outstanding.focus();" onblur="calculatetotal2(this);" maxlength="6" value="0" onFocus="this.select();">-->
            			<%else%>
            			<input type="text" name="counterdata[KEY4]" id="counterdata_KEY4" size="20" onchange="return minussignsforkey4();" onkeypress="return onlyNumbersminus();" onKeyDown="if(event.keyCode==13)  this.form.counterdata_Outstanding.focus();" onblur="calculatetotal2(this);" maxlength="6" value="0" onFocus="this.select();">
            			<%end%>

            		
            		<%else%>
            		<!--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-------->
            		          			<input type="text" name="counterdata[KEY4]" id="counterdata_KEY4" size="20"  value="0" disabled>
            	
            		<% end %>


            		
            		</td>
          
          
            
            
          </tr>
          <tr>
          
					<td width="25%" height="34" align="right">&nbsp;</td>
					<td width="25%" height="34"></td>
					 <td width="25%" height="34" align="right"><label for="counterdata_Outstanding">O/S</label></td>
					 <td width="25%" height="34">
					
<%= text_field 'counterdata', 'Outstanding',:onchange=>"return minussignsforos();",:onkeypress=>"return onlyNumbersminus();",:onKeyDown=>"showsave();",:onblur=>"calculatetotal2(this);",:onFocus=>"this.select();",:size=>"20"%></td>

 </td>
					
          </tr>  
          <tr>
          			 <td width="25%" height="33" align="right"><label for="counterdata_total1">Total</label></td>
          			 <td width="25%" height="34">

          			 <input type=text name="total1" id="total1" value="<%= @session['total1'] %>" size="20" ></td>
					 <td width="25%" height="33" align="right"><label for="counterdata_total1">Total</label></td>
					 <td width="25%" height="34">
					 <input type=text name="total2" id="total2" value="<%= @session['total2'] %>" size="20" ></td>

          </tr>
          
        </table>
        </td>
      </tr>
      <tr>
        <td width="100%" height="10" align=center>

  <%= submit_tag '  Save  ', :id=>"save",:onclick=>"return Check();" %>
  <%= submit_to_remote '  Back  ','Back',:url => {:controller=>'counterdata',:action => "cancelcounterdata" }%></p>

</td>
      </tr>
    </table>
    </td>
  </tr>
</table>

<% end %>
</body>

</html>